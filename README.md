In this branch I have broken out each small function for which I have changes to suggest. Each function gets its own eponymous "module" (program).

I've put in plenty of comments, usually prefaced with "DPB". 

Also, when I have several versions of a function in the same module, I've tried to remember to number them.

See what you think.
